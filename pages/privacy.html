<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>معاينة منتج - BODA</title>
    <link rel="stylesheet" href="../assets/css/home.css">
    <link rel="stylesheet" href="../assets/fonts/inter.css">
    <link rel="stylesheet" href="../assets/fonts/material-icons-outlined.css">
    <style>
        /* Minimal TFASIL-like card styles (adapted to project CSS) */
        :root { --card-bg: #ffffff; --accent: #afde3d; }
        body { background: linear-gradient(180deg,#eef2ff 0%, #f8fafc 100%); font-family: Inter, sans-serif; }
        .tf-container { max-width: 980px; margin: 3rem auto; padding: 1rem; }
        .tf-card { display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; background: var(--card-bg); border-radius: 16px; box-shadow: 0 10px 30px rgba(2,6,23,0.08); overflow: hidden; }
        .tf-media { background: linear-gradient(135deg,var(--accent),#94cc12); padding: 2rem; display:flex; align-items:center; justify-content:center; }
        .tf-media img { max-width: 90%; height: auto; object-fit:contain; }
        .tf-info { padding: 2rem; display:flex; flex-direction:column; gap:1rem; }
        .tf-title { font-size: 1.75rem; font-weight:800; color:#0b1220; }
        .tf-price { font-size:1.5rem; color:#0b1220; font-weight:800; }
        .tf-desc { color:#334155; line-height:1.6; }
        .tf-controls { display:flex; gap:0.75rem; align-items:center; margin-top:1rem; }
        .btn { padding:0.8rem 1.25rem; border-radius:10px; border:none; cursor:pointer; font-weight:700; }
        .btn-primary { background: linear-gradient(45deg,var(--accent),#090979); color:#fff; }
        .btn-ghost { background: rgba(0,0,0,0.05); }
        @media (max-width:800px) { .tf-card { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <div class="tf-container">
        <div class="tf-card" id="tfCard">
            <div class="tf-media">
                <img id="tfMainImage" src="../assets/images/1f2269e3-3b3c-4c33-9bfe-606c60be3058.jpg" alt="product image">
            </div>
            <div class="tf-info">
                <div>
                    <div id="tfCategory" style="font-weight:700;color:#6b7280;">... التصنيف</div>
                    <div id="tfTitle" class="tf-title">جاري تحميل المنتج...</div>
                    <div class="tf-price" id="tfPrice">0 ج.م</div>
                </div>
                <p id="tfDescription" class="tf-desc">وصف المنتج سيظهر هنا عندما تختار منتج.</p>

                <div class="tf-controls">
                    <div style="display:flex;align-items:center;gap:0.5rem;">
                        <button class="btn btn-ghost" id="tfQtyMinus">-</button>
                        <input id="tfQty" type="number" value="1" min="1" style="width:56px;text-align:center;border-radius:8px;border:1px solid #e6e6e6;padding:6px;" />
                        <button class="btn btn-ghost" id="tfQtyPlus">+</button>
                    </div>
                    <div style="margin-left:auto;display:flex;gap:0.5rem;">
                        <button class="btn btn-primary" id="tfAddToCart">أضف إلى العربة</button>
                        <button class="btn btn-ghost" id="tfWishlist">❤</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        // Render product into this TFASIL-like card using existing store
        (function(){
            const urlParams = new URLSearchParams(window.location.search);
            const id = urlParams.get('id') || 'shirt-001';
            const p = (typeof BODAStore !== 'undefined' && BODAStore.getProductById) ? BODAStore.getProductById(id) : (window.getProductById ? getProductById(id) : null);
            const mainImage = document.getElementById('tfMainImage');
            const title = document.getElementById('tfTitle');
            const price = document.getElementById('tfPrice');
            const desc = document.getElementById('tfDescription');
            const cat = document.getElementById('tfCategory');
            if (p) {
                title.textContent = p.name;
                price.textContent = (p.discountPrice && p.discountPrice < p.price) ? p.discountPrice.toFixed(2)+' ج.م' : p.price.toFixed(2)+' ج.م';
                desc.textContent = p.description || 'لا يوجد وصف';
                cat.textContent = p.category || '';
                const img = (p.images && p.images.length>0) ? p.images[0] : p.image;
                if (img) {
                    try { mainImage.src = (typeof getImagePath==='function') ? getImagePath(img) : img; } catch(e){ mainImage.src = img; }
                }
            }

            const qtyInput = document.getElementById('tfQty');
            document.getElementById('tfQtyPlus').addEventListener('click', ()=> qtyInput.value = parseInt(qtyInput.value||1)+1);
            document.getElementById('tfQtyMinus').addEventListener('click', ()=> { qtyInput.value = Math.max(1, parseInt(qtyInput.value||1)-1); });

            document.getElementById('tfAddToCart').addEventListener('click', ()=>{
                const q = parseInt(qtyInput.value||1);
                if (typeof BODAStore !== 'undefined' && typeof BODAStore.addToCart === 'function') {
                    BODAStore.addToCart(p, q);
                    BODAStore.updateCartCount && BODAStore.updateCartCount();
                    alert('✅ تم إضافة المنتج إلى العربة');
                } else if (typeof addToCart === 'function') {
                    addToCart(p, q);
                    alert('✅ تم إضافة المنتج إلى العربة');
                } else {
                    alert('حدث خطأ: لا توجد دالة إضافة للعربة متاحة');
                }
            });
        })();
    </script>
</body>
</html>